# ğŸš¨ Exploiting CVE-2021-38297: A Journey into GO Wasm Buffer Overflow ğŸš¨

## ğŸŒ Overview of the Vulnerability ğŸŒ

WebAssembly (WASM) ğŸŒ, a cutting-edge binary instruction format, enables the seamless execution of high-level languages like C, C++, Rust, and GO in modern web browsers. However, the discovery of CVE-2021-38297 ğŸš© revealed a critical flaw within GO's compilation and loading process for GO-compiled WASM binaries. This vulnerability, found in the JavaScript WASM loader (`wasm_exec.js`) provided by GO, allowed for the unrestricted inclusion of data in the `argv` argument. With `argv` stored in the linear memory of WASM, malicious actors could potentially exploit this to overwrite the linear memory of the GO-compiled WASM program with an oversized `argv` input, leading to unpredictable and potentially hazardous outcomes. This vulnerability was a significant concern in versions of GO prior to 1.17.2.

## ğŸ’» Vulnerable Application: Vuln-Twitter ğŸ’»

In our proof of concept, we introduce "Vuln-Twitter," a mock social media platform that permits user-generated content through posts and comments. Utilizing a Node.js web server and SQLite for data storage, Vuln-Twitter's front-end leverages plain JavaScript along with a GO WASM module named `wordprocessor.wasm` for dynamic content rendering. This module, notably, includes methods like `toLeetSpeak`, transforming user inputs into stylized "LeetSpeak" for an engaging user experience.

### Exploiting the Buffer Overflow

Our exploration reveals a critical point of exploitation during the content rendering phase, where each comment undergoes transformation by the GO WASM module. A specially crafted oversized comment can trigger the vulnerability, leading to a buffer overflow that manipulates the original post content, demonstrating a classic Stored XSS attack vector. This vulnerability not only underscores the potential for malicious data manipulation but also highlights the broader implications of secure programming practices in the context of web development and WASM applications.

### Reproducing the Exploit

For enthusiasts and researchers keen on exploring this vulnerability further, we provide detailed steps to reproduce the exploit environment using a specific vulnerable version of GO. This hands-on approach facilitates a deeper understanding of the vulnerability's mechanics and potential mitigation strategies.

## ğŸ› ï¸ Patching and Mitigation ğŸ› ï¸

Acknowledging the severity of this vulnerability, we also outline a comprehensive patching strategy, employing an updated and secure version of GO to mitigate the risk. This section serves as a guide for developers and system administrators to fortify their applications against such vulnerabilities, emphasizing the importance of regular software updates and vigilant security practices.

## ğŸ’¡ Conclusion and Reflections ğŸ’¡

Our journey through the exploitation and mitigation of CVE-2021-38297 offers valuable insights into the challenges and opportunities presented by the integration of high-level programming languages in web environments through WASM. It prompts a critical examination of security practices in software development, urging a proactive approach to vulnerability management and the adoption of secure coding standards.

## ğŸ“ Presentation and Academic Contribution ğŸ“

As students of Carnegie Mellon University, our investigation into CVE-2021-38297 contributes to the broader academic and professional discourse on cybersecurity, offering a practical case study on the implications of emerging technologies on software security. Our presentation materials, available for review, further elucidate our findings and methodologies, inviting dialogue and collaboration among the cybersecurity community.

## ğŸŒŸ Credits & Contributions ğŸŒŸ

This project is a testament to collaborative research and academic inquiry, spearheaded by a dedicated team of students and researchers:

- Paras Saxena (@paras98)
- Gopala Krishnan (@gkrishnan724)
- Zhejia Yang (@zildjianpoi)
- Shubham Kulkarni (@shubhamkulkarni97)
- Anisha Nilakantan

## ğŸ”— Sources & Further Reading ğŸ”—

For those interested in delving deeper into CVE-2021-38297 and its broader implications, we provide a curated list of resources and readings, ranging from official security bulletins to technical blogs and academic papers. These materials offer comprehensive insights into the vulnerability, its impact on software security, and the ongoing efforts to ensure the safety and integrity of web applications.
* https://www.ibm.com/support/pages/security-bulletin-ibm-event-streams-affected-potential-buffer-overflow-golang-cve-2021-38297-0
* https://vulmon.com/vulnerabilitydetails?qid=CVE-2021-38297&scoretype=cvssv3
* https://pedromarquez.dev/blog/2023/2/node_golang_wasm
* https://nvd.nist.gov/vuln/detail/CVE-2021-38297
* https://github.com/golang/go/issues/48797
* https://github.com/golang/go/commit/f63250238be548b7c6c24ae840541102a5cfef99
* https://jfrog.com/blog/cve-2021-38297-analysis-of-a-go-web-assembly-vulnerability/
* https://stackoverflow.com/questions/64763007/why-is-webassembly-safe-and-what-is-linear-memory-model
* https://webassembly.org/
* https://hacks.mozilla.org/2019/08/webassembly-interface-types/
* https://blog.protekkt.com/blog/basic-webassembly-buffer-overflow-exploitation-example
* https://www.usenix.org/system/files/sec20_slides_lehmann.pdf
* https://xeiaso.net/talks/wasm-abi/